---
layout: post
title: __block关键字修饰变量 · __block keyword variables
tags: iOS
categories: Dev
---

Normally, variables that are used in blocks are copied, thus any modification done to these variables don't show outside the block. 

通常情况下，在block中的变量默认是将外部变量复制到其数据结构中来访问实现的，在block中对变量的任何修改不会影响到外部变量。

---

![block](/images/block/block2.png)


{% highlight objc %}
char localCharacter;

void (^aBlock)(void) = ^(void) {
    int c;
    c = localCharacter; // use localCharacter value but cannot change it
};
{% endhighlight %}

---

When they are marked with `__block` , the modifications done inside the block are also visible outside of it, because the variables are no longer copied, but directly used as the non-local variables.

当使用 `__block` 关键字来修饰的外部变量时，在block中对变量的改变则会同样影响到外部变量，是因为在block中将不再是访问该外部变量复制的值，而是直接访问了该外部变量。

---

![block](/images/block/block1.png)

{% highlight objc %}
__block char localCharacter;

void (^aBlock)(void) = ^(void) {
    localCharacter = 'a'; // could change localCharacter value in enclosing scope
};
{% endhighlight %}