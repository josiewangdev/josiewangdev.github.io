---
layout: post
title: 动态高度的列表头尾 · Auto sized table view header & footer
tags: iOS
categories: Dev
---

**Problem Description:**

The table view has a header and footer which allows you to put UI controls above and below the data in your table view. 

The problem is that the header and footer do not participate with Auto Layout.The height of the header and footer need to be set manually. 

You can set an initial size for your header in Xcode, but that may not work for all phone sizes or situations where you have dynamic content in your header that you hide/show at runtime.

**问题描述:**

列表视图通常有一个表头和表尾使你可以在其中将按钮等组件覆于数据上。

但问题是表头和表尾不能动态布局。表头表尾必须手动设置一个固定高度。

你可以在XCode中为其设置一个初始大小，但是当你的表头表为是在运行时用动态内容填充的时候，这个尺寸可能并不能适配所有的手机型号。

---

**Solution:**

These functions will resize the header or footer to the proper size based on the Auto Layout constraints.

**解决方法:**

这些方法将会根据自动布局的约束重新将表头和表尾调整成合适的大小。

---

{% highlight swift %}

func sizeHeaderToFit() {
    if let headerView = tableView.tableHeaderView {
        headerView.setNeedsLayout()
        headerView.layoutIfNeeded()
        let height = headerView.systemLayoutSizeFitting(UILayoutFittingCompressedSize).height
        var frame = headerView.frame
        frame.size.height = height
        headerView.frame = frame
        tableView.tableHeaderView = headerView
    }
}
    
func sizeFooterToFit() {
    if let footerView = tableView.tableFooterView {
        footerView.setNeedsLayout()
        footerView.layoutIfNeeded()
        let height = footerView.systemLayoutSizeFitting(UILayoutFittingCompressedSize).height
        var frame = footerView.frame
        frame.size.height = height
        footerView.frame = frame
        tableView.tableFooterView = footerView
    }
}

{% endhighlight %}

---

You can call these functions when your header or footer view content has changed.

接下来你可以在表头表尾填充内容改变的时候调用这些方法。

---

{% highlight swift %}
override func viewDidLoad() {
    super.viewDidLoad()
    sizeHeaderToFit()
}
{% endhighlight %}

---

[[Ref.参考] Extending UITableViewController](https://spin.atomicobject.com/2017/08/11/swift-extending-uitableviewcontroller/)

